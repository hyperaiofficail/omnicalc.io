<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Super Advanced Calculator</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* ----------------------------------------------------
           CSS: CYBERPUNK / GLASSMORPHISM STYLE
           ---------------------------------------------------- */
        :root {
            --bg-dark: #09090b;
            --glass-bg: rgba(20, 20, 30, 0.6);
            --glass-border: rgba(255, 255, 255, 0.1);
            --neon-blue: #00f2ff;
            --neon-pink: #ff0055;
            --text-main: #ffffff;
            --text-sec: #a0a0a0;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', sans-serif;
        }

        body {
            background: radial-gradient(circle at top left, #1a1a2e, #16213e, #0f3460);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            color: var(--text-main);
            overflow: hidden; /* Prevent background scroll */
        }

        /* Decorative blobs for glass effect */
        .blob {
            position: absolute;
            width: 300px;
            height: 300px;
            border-radius: 50%;
            filter: blur(80px);
            z-index: -1;
            opacity: 0.6;
        }
        .blob-1 { background: var(--neon-blue); top: -50px; left: -50px; }
        .blob-2 { background: var(--neon-pink); bottom: -50px; right: -50px; }

        /* MAIN CONTAINER */
        .app-container {
            width: 400px;
            height: 750px;
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 25px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            position: relative;
        }

        /* TABS (Calc | Unit | History) */
        .nav-tabs {
            display: flex;
            justify-content: space-around;
            padding: 15px;
            background: rgba(0,0,0,0.2);
        }

        .tab-btn {
            background: none;
            border: none;
            color: var(--text-sec);
            font-size: 14px;
            cursor: pointer;
            padding: 5px 10px;
            border-radius: 20px;
            transition: 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: bold;
        }

        .tab-btn.active {
            color: var(--bg-dark);
            background: var(--neon-blue);
            box-shadow: 0 0 10px var(--neon-blue);
        }

        /* SCREENS AREA */
        .screen-content {
            flex: 1;
            position: relative;
        }

        .view-section {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            opacity: 0;
            pointer-events: none;
            transition: 0.3s;
            padding: 20px;
            display: flex;
            flex-direction: column;
        }

        .view-section.active-view {
            opacity: 1;
            pointer-events: all;
            z-index: 10;
        }

        /* --- CALCULATOR VIEW --- */
        .calc-display {
            text-align: right;
            margin-bottom: 20px;
            height: 120px;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
        }

        .calc-history-text {
            color: var(--neon-pink);
            font-size: 14px;
            min-height: 20px;
        }

        .calc-main-text {
            font-size: 48px;
            font-weight: 300;
            word-break: break-all;
        }

        .keypad {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
            flex-grow: 1;
        }

        .btn {
            border: none;
            background: rgba(255,255,255,0.05);
            color: white;
            font-size: 18px;
            border-radius: 12px;
            cursor: pointer;
            transition: 0.2s;
            box-shadow: inset 0 0 0 1px rgba(255,255,255,0.05);
        }

        .btn:hover { background: rgba(255,255,255,0.1); transform: translateY(-2px); }
        .btn:active { transform: scale(0.95); }

        .btn-op { color: var(--neon-blue); font-weight: bold; }
        .btn-sci { color: var(--neon-pink); font-size: 14px; }
        .btn-eq { 
            background: linear-gradient(135deg, var(--neon-blue), #00c3ff);
            color: #000;
            font-weight: bold;
            grid-column: span 2;
        }
        .btn-voice { color: #00ff88; } /* Mic color */

        /* --- UNIT CONVERTER VIEW --- */
        .converter-box {
            background: rgba(255,255,255,0.05);
            padding: 20px;
            border-radius: 15px;
            margin-top: 20px;
        }
        
        select, input {
            width: 100%;
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--glass-border);
            color: white;
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 15px;
            font-size: 16px;
            outline: none;
        }
        
        label { font-size: 12px; color: var(--text-sec); display: block; margin-bottom: 5px; }

        /* --- HISTORY VIEW --- */
        .history-list {
            overflow-y: auto;
            max-height: 100%;
        }
        .history-item {
            background: rgba(255,255,255,0.05);
            margin-bottom: 10px;
            padding: 10px;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .h-eq { font-size: 12px; color: var(--text-sec); }
        .h-res { font-size: 18px; color: var(--neon-blue); }

        /* ANIMATION */
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(0, 242, 255, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(0, 242, 255, 0); }
            100% { box-shadow: 0 0 0 0 rgba(0, 242, 255, 0); }
        }
        .listening { animation: pulse 1.5s infinite; color: white !important; background: #ff0055 !important; }

    </style>
</head>
<body>

    <div class="blob blob-1"></div>
    <div class="blob blob-2"></div>

    <div class="app-container">
        <div class="nav-tabs">
            <button class="tab-btn active" onclick="switchTab('calc')">Calculator</button>
            <button class="tab-btn" onclick="switchTab('unit')">Converter</button>
            <button class="tab-btn" onclick="switchTab('hist')">History</button>
        </div>

        <div class="screen-content">
            
            <div id="view-calc" class="view-section active-view">
                <div class="calc-display">
                    <div class="calc-history-text" id="calc-upper"></div>
                    <div class="calc-main-text" id="calc-screen">0</div>
                </div>
                <div class="keypad">
                    <button class="btn btn-sci" onclick="handleMath('sin')">sin</button>
                    <button class="btn btn-sci" onclick="handleMath('cos')">cos</button>
                    <button class="btn btn-sci" onclick="handleMath('tan')">tan</button>
                    <button class="btn btn-sci" onclick="handleMath('sqrt')">√</button>

                    <button class="btn btn-sci" onclick="handleMath('log')">log</button>
                    <button class="btn btn-sci" onclick="insert('(')">(</button>
                    <button class="btn btn-sci" onclick="insert(')')">)</button>
                    <button class="btn btn-op" onclick="command('AC')">AC</button>

                    <button class="btn" onclick="insert('7')">7</button>
                    <button class="btn" onclick="insert('8')">8</button>
                    <button class="btn" onclick="insert('9')">9</button>
                    <button class="btn btn-op" onclick="insert('/')">÷</button>

                    <button class="btn" onclick="insert('4')">4</button>
                    <button class="btn" onclick="insert('5')">5</button>
                    <button class="btn" onclick="insert('6')">6</button>
                    <button class="btn btn-op" onclick="insert('*')">×</button>

                    <button class="btn" onclick="insert('1')">1</button>
                    <button class="btn" onclick="insert('2')">2</button>
                    <button class="btn" onclick="insert('3')">3</button>
                    <button class="btn btn-op" onclick="insert('-')">−</button>

                    <button class="btn btn-voice" id="mic-btn" onclick="startDictation()"><i class="fa-solid fa-microphone"></i></button>
                    <button class="btn" onclick="insert('0')">0</button>
                    <button class="btn" onclick="insert('.')">.</button>
                    <button class="btn btn-op" onclick="insert('+')">+</button>

                    <button class="btn btn-op" onclick="command('DEL')">⌫</button>
                    <button class="btn btn-eq" onclick="calculate()">=</button>
                </div>
            </div>

            <div id="view-unit" class="view-section">
                <h2 style="margin-bottom: 20px; color: var(--neon-blue);">Unit Converter</h2>
                
                <div class="converter-box">
                    <label>Category</label>
                    <select id="conv-category" onchange="updateUnits()">
                        <option value="length">Length</option>
                        <option value="weight">Weight</option>
                        <option value="temp">Temperature</option>
                    </select>

                    <label>From</label>
                    <div style="display: flex; gap: 10px;">
                        <input type="number" id="conv-input" placeholder="0" oninput="convert()">
                        <select id="conv-from" onchange="convert()"></select>
                    </div>

                    <div style="text-align: center; font-size: 20px; color: var(--neon-pink);">↓</div>

                    <label>To</label>
                    <div style="display: flex; gap: 10px;">
                        <input type="text" id="conv-result" readonly placeholder="Result">
                        <select id="conv-to" onchange="convert()"></select>
                    </div>
                </div>
            </div>

            <div id="view-hist" class="view-section">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <h2 style="color: var(--neon-blue);">History</h2>
                    <button onclick="clearHistory()" style="background: none; border: none; color: var(--neon-pink); cursor: pointer;">Clear All</button>
                </div>
                <div class="history-list" id="history-container">
                    <div style="text-align: center; color: gray; margin-top: 20px;">No history yet</div>
                </div>
            </div>

        </div>
    </div>

    <script>
        /* ----------------------------------------------------
           JAVASCRIPT LOGIC
           ---------------------------------------------------- */
        
        // --- 1. TAB SWITCHING ---
        function switchTab(tabName) {
            // Remove active class from buttons
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            // Hide all views
            document.querySelectorAll('.view-section').forEach(v => v.classList.remove('active-view'));

            // Activate chosen one
            if(tabName === 'calc') {
                document.querySelector('.tab-btn:nth-child(1)').classList.add('active');
                document.getElementById('view-calc').classList.add('active-view');
            } else if(tabName === 'unit') {
                document.querySelector('.tab-btn:nth-child(2)').classList.add('active');
                document.getElementById('view-unit').classList.add('active-view');
                updateUnits(); // Init units
            } else {
                document.querySelector('.tab-btn:nth-child(3)').classList.add('active');
                document.getElementById('view-hist').classList.add('active-view');
            }
        }

        // --- 2. CALCULATOR ENGINE ---
        let expression = "";
        const screen = document.getElementById('calc-screen');
        const upper = document.getElementById('calc-upper');

        function insert(val) {
            if(expression === "Error") expression = "";
            expression += val;
            updateScreen();
        }

        function command(cmd) {
            if(cmd === 'AC') {
                expression = "";
                upper.innerText = "";
            } else if (cmd === 'DEL') {
                expression = expression.slice(0, -1);
            }
            updateScreen();
        }

        function handleMath(func) {
            expression += func + "(";
            updateScreen();
        }

        function updateScreen() {
            screen.innerText = expression === "" ? "0" : expression;
        }

        function calculate() {
            try {
                let evalExp = expression
                    .replace(/×/g, '*')
                    .replace(/÷/g, '/')
                    .replace(/sin/g, 'Math.sin')
                    .replace(/cos/g, 'Math.cos')
                    .replace(/tan/g, 'Math.tan')
                    .replace(/log/g, 'Math.log10')
                    .replace(/sqrt/g, 'Math.sqrt');

                let result = eval(evalExp);
                
                // Add to history before clearing
                addToHistory(expression, result);

                upper.innerText = expression + " =";
                expression = result.toString();
                screen.innerText = expression;
            } catch (e) {
                expression = "Error";
                screen.innerText = "Error";
            }
        }

        // --- 3. VOICE RECOGNITION (WEB SPEECH API) ---
        function startDictation() {
            if (window.hasOwnProperty('webkitSpeechRecognition')) {
                const recognition = new webkitSpeechRecognition();
                const micBtn = document.getElementById('mic-btn');

                recognition.continuous = false;
                recognition.interimResults = false;
                recognition.lang = "en-US";
                
                micBtn.classList.add('listening');

                recognition.start();

                recognition.onresult = function(e) {
                    let text = e.results[0][0].transcript;
                    // Basic parsing: "two plus two" -> "2+2"
                    text = text.replace(/plus/g, "+")
                               .replace(/minus/g, "-")
                               .replace(/times/g, "*")
                               .replace(/divided by/g, "/")
                               .replace(/x/g, "*") // sometimes speech hears 'x'
                               .replace(/[a-zA-Z]/g, "") // remove remaining letters
                               .trim();
                    
                    expression += text;
                    updateScreen();
                    micBtn.classList.remove('listening');
                    recognition.stop();
                    // Auto calculate if it looks complete
                    setTimeout(calculate, 500);
                };

                recognition.onerror = function(e) {
                    micBtn.classList.remove('listening');
                    recognition.stop();
                };
            } else {
                alert("Voice input not supported in this browser. Try Chrome.");
            }
        }

        // --- 4. HISTORY ---
        let historyData = [];
        function addToHistory(exp, res) {
            historyData.unshift({ exp, res });
            renderHistory();
        }

        function renderHistory() {
            const container = document.getElementById('history-container');
            container.innerHTML = "";
            if(historyData.length === 0) {
                container.innerHTML = '<div style="text-align: center; color: gray;">No history yet</div>';
                return;
            }
            historyData.forEach(item => {
                const div = document.createElement('div');
                div.className = 'history-item';
                div.innerHTML = `
                    <div>
                        <div class="h-eq">${item.exp}</div>
                        <div class="h-res">= ${item.res}</div>
                    </div>
                `;
                div.onclick = () => {
                    expression = item.res.toString();
                    updateScreen();
                    switchTab('calc');
                };
                container.appendChild(div);
            });
        }
        function clearHistory() {
            historyData = [];
            renderHistory();
        }

        // --- 5. UNIT CONVERTER ENGINE ---
        const unitData = {
            length: { 'Meter': 1, 'Kilometer': 0.001, 'Centimeter': 100, 'Millimeter': 1000, 'Inch': 39.3701, 'Foot': 3.28084 },
            weight: { 'Kilogram': 1, 'Gram': 1000, 'Pound': 2.20462, 'Ounce': 35.274 },
            temp: { 'Celsius': 'c', 'Fahrenheit': 'f', 'Kelvin': 'k' }
        };

        function updateUnits() {
            const cat = document.getElementById('conv-category').value;
            const fromSel = document.getElementById('conv-from');
            const toSel = document.getElementById('conv-to');
            
            fromSel.innerHTML = "";
            toSel.innerHTML = "";

            const units = Object.keys(unitData[cat]);
            units.forEach(u => {
                fromSel.add(new Option(u, u));
                toSel.add(new Option(u, u));
            });
            convert();
        }

        function convert() {
            const cat = document.getElementById('conv-category').value;
            const val = parseFloat(document.getElementById('conv-input').value);
            const from = document.getElementById('conv-from').value;
            const to = document.getElementById('conv-to').value;
            const resField = document.getElementById('conv-result');

            if(isNaN(val)) { resField.value = ""; return; }

            let result;

            if (cat === 'length' || cat === 'weight') {
                // Convert to base unit then to target
                const base = val / unitData[cat][from]; 
                result = base * unitData[cat][to];
            } else {
                // Temperature (Special formulas)
                if(from === to) result = val;
                else if(from === 'Celsius' && to === 'Fahrenheit') result = (val * 9/5) + 32;
                else if(from === 'Celsius' && to === 'Kelvin') result = val + 273.15;
                else if(from === 'Fahrenheit' && to === 'Celsius') result = (val - 32) * 5/9;
                else if(from === 'Fahrenheit' && to === 'Kelvin') result = (val - 32) * 5/9 + 273.15;
                else if(from === 'Kelvin' && to === 'Celsius') result = val - 273.15;
                else if(from === 'Kelvin' && to === 'Fahrenheit') result = (val - 273.15) * 9/5 + 32;
            }

            resField.value = parseFloat(result.toFixed(4));
        }

        // Init
        updateUnits();

    </script>
</body>
</html>
